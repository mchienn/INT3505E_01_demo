{% extends "layout.html" %}

{% block content %}
<div class="docs-container">
    <!-- Sidebar -->
    <aside class="sidebar" style="top: 80px;">
        <h4>Getting Started</h4>
        <ul>
            <li><a href="#introduction" class="active">Introduction</a></li>
            <li><a href="#authentication">Authentication</a></li>
            <li><a href="#rate-limits">Rate Limits</a></li>
        </ul>
        <h4>Resources</h4>
        <ul>
            <li><a href="#posts">Posts API</a></li>
            <li><a href="#users">Users API</a></li>
        </ul>
        <h4>Support</h4>
        <ul>
            <li><a href="#errors">Error Codes</a></li>
            <li><a href="#sdks">SDKs & Libraries</a></li>
        </ul>
    </aside>

    <!-- Main Content -->
    <main class="docs-content">
        <section id="introduction">
            <h1>API Documentation</h1>
            <p>Welcome to the DevPortal API. Our API follows RESTful principles and serves data in JSON format.</p>
            <div style="margin-top: 1.5rem;">
                <a href="{{ url_for('static', filename='swagger.json') }}" download class="btn btn-secondary"
                    style="display: inline-flex; align-items: center; gap: 0.5rem;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Download OpenAPI Spec (JSON)
                </a>
            </div>
        </section>

        <section id="authentication" style="margin-top: 4rem;">
            <h2>Authentication & Key Management</h2>
            <p>The API uses <strong>Bearer Authentication</strong>. You must send your API key in the
                <code>Authorization</code> header.</p>

            <div class="code-block" style="position: relative;">
                Authorization: Bearer sk_live_123456789
                <button class="btn btn-secondary"
                    style="position: absolute; right: 10px; top: 10px; padding: 0.25rem 0.75rem; font-size: 0.75rem;">Copy</button>
            </div>

            <h3 style="margin-top: 2rem; font-size: 1.25rem;">Key Lifecycle Flow</h3>
            <div
                style="background: var(--bg-secondary); padding: 1.5rem; border-radius: 12px; margin-top: 1rem; border: 1px solid var(--glass-border);">
                <ol
                    style="margin-left: 1.5rem; color: var(--text-secondary); display: flex; flex-direction: column; gap: 1rem;">
                    <li>
                        <strong style="color: var(--text-primary)">1. Sign Up / Log In</strong>
                        <p>Create an account on the Developer Dashboard to access your workspace.</p>
                    </li>
                    <li>
                        <strong style="color: var(--text-primary)">2. Create API Key</strong>
                        <p>Navigate to "Settings > API Keys" and click "Generate New Key". Copy it immediatelyâ€”it won't
                            be shown again.</p>
                    </li>
                    <li>
                        <strong style="color: var(--text-primary)">3. Revoke / Rotate</strong>
                        <p>If a key is compromised, use the "Revoke" button instantly. You can then generate a new key
                            to rotate your credentials.</p>
                    </li>
                </ol>
            </div>
        </section>

        <section id="rate-limits" style="margin-top: 4rem;">
            <h2>Rate Limits</h2>
            <p>We use a token bucket algorithm. If you exceed the limit, you'll receive a
                <code>429 Too Many Requests</code> response containing a <code>Retry-After</code> header indicating how
                many seconds to wait.</p>
            <table>
                <thead>
                    <tr>
                        <th>Tier</th>
                        <th>Requests/Second</th>
                        <th>Burst Capacity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Free</td>
                        <td>1 req/s</td>
                        <td>5</td>
                    </tr>
                    <tr>
                        <td>Pro</td>
                        <td>20 req/s</td>
                        <td>50</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="posts" style="margin-top: 4rem;">
            <h2>Endpoints</h2>

            <div class="endpoint">
                <h3><span class="method get">GET</span> List Posts</h3>
                <p>Retrieve a list of posts from the platform.</p>
                <div class="code-block">GET /api/v1/posts</div>

                <h4>Parameters</h4>
                <table>
                    <tr>
                        <th>Name</th>
                        <th>In</th>
                        <th>Type</th>
                        <th>Required</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>limit</td>
                        <td>query</td>
                        <td>integer</td>
                        <td>No</td>
                        <td>Max number of results (default 10)</td>
                    </tr>
                </table>

                <h4>Response Example (200 OK)</h4>
                <pre class="code-block">
{
"data": [
{
  "id": "1",
  "title": "Welcome to the API",
  "content": "This is real data derived from the backend."
}
],
"meta": {
"page": 1,
"total": 100
}
}
                </pre>

                <h4>Possible Errors</h4>
                <table>
                    <tr>
                        <th>Code</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>401</td>
                        <td>Unauthorized - Invalid or Missing Key</td>
                    </tr>
                    <tr>
                        <td>429</td>
                        <td>Too Many Requests</td>
                    </tr>
                </table>
            </div>

            <div class="endpoint">
                <h3><span class="method post">POST</span> Create Post</h3>
                <p>Create a new post programmatically.</p>
                <div class="code-block">POST /api/v1/posts</div>

                <h4>Request Body</h4>
                <pre class="code-block">
{
"title": "New Update",
"content": "We have launched..."
}
                </pre>

                <h4>Response Example (201 Created)</h4>
                <pre class="code-block">
{
"id": "124",
"title": "New Update",
"content": "We have launched...",
"status": "published",
"created_at": "2023-11-20T10:00:00Z"
}
                </pre>
            </div>
        </section>
    </main>
</div>
{% endblock %}